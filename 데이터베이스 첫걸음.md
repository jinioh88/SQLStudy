# 데이터베이스 첫걸음 책 정리자료.
  - 개인 정리용이라 자세한 사항은 책을 참조하길...

## 1장 데이터베이스란?
### NoSQL
  - 'Not only SQL'의 줄임말.
  - 관계형 데이터베이스에 있는 기능 일부를 버려 성능을 높인다.
  - 대량의 데이터를 고속으로 처리해야 하는 웹 서비스와 잘 맞음.

## 2장 관계형 데이터베이스
### 대표적인 DBMS를 알아보자
  - 관계형 데이터베이스는 줄여서 RDB라고도 표기한다 .
  - 관계 Relation이란 2차원 표를 표기 할 때 사용하는 단어이다. 
  - 추상과 구상의 차이(데이터베이스와 DBMS)
    - 데이터베이스는 모빌슈트이고 DBMS는 건담, 자쿠 개념이다. 
  - 사용되는 소프트웨어가 크게 운영체제, 미들웨어, 애플리케이션 3가지로 구분할 수 있다.
    - DBMS는 미들웨어에 위치한다. 
  - 마이그레이션 : 하나의 조합(OS+DBMS)에서 다른 조합으로 시스템을 변경하는 일.

## 4장 데이터베이스와 아키텍처 구성
### 다중화에 대해 생각해보자
  - 2대 디비 서버가 있다고 할 떄 1대가 고장났다하더라도 나머지 한대가 동작하면 서비스 정지를 막을 수 있는 것. 

### 아키텍처란
  - 여러 의미가 있지만 '시스템을 만들기 위한 물리 레벨의 조합'의 의미.
  - 하드웨어와 미들웨어의 구성.
  - 시스템의 목적과 기능을 나타낸다. 

###  Web 3계층
  - 웹 서버 계층, 애플리케이션 계층 데이터베이스 계층
  - 웹서버 : 클라이언트로 부터 접속요청(HTTP요청)을 직접 받아 그 처리를 뒷단의 애플리케이션 계층에 넘기고 그 결과를 클라이언트에 반환한다.
  - 애플리케이션 계층 : 비즈니스 로직을 구현한 애플리케이션이 동작하는 층. 처리 결과를 웹 서버로 반환. 

### 데이터베이스의 아키텍처(가용성과 확장성의 확보)
  - 서버가 1대라 가용성과 확장성의 문제가 남아 있음. 해결책은??
  - 아키텍처 설계에서 견고한 시스템을 만들기 위한 가장 중요한 점은 가용성이다.
  - 가용성을 높이는 2가지 전략
    - 심장전략(고품질-소수전략) : 컴포넌트의 신뢰성을 높여 간다.
    - 신장전략(저품질-다수전략) : 요즘은 신장전략에 손을 들어주고 있다. 
  - 클러스트
    - 신장전략처럼 동일한 기능의 컴포넌트를 병렬화 하는 것을 '클러스트링'이라 한다. 
    - 즉 클러스트란 동일한 기능의 컴포넌트를 복수 개 준비해 한 개의 기능을 실현한다는 의미

### DB 서버의 다중화 - 클러스트링
  - 데이터를 보존하는 영속계층이라 다중화에 고민이 필요하다. 
  - 데이터 베이스는 대량의 데이터를 영구 보존해야해 데이터 보존하는 매체가 필요하다. 
  - 서버 내부 로컬 저장소나 메모리로 이 조건을 충족시키지 못해 전용 외부 저장소를 사용한다. 
  - 디비서버의 아키텍처는 저장소와 묶어 생각해야 한다. 
  - Active-Active 구성
    - 디비 서버를 동시에 가동하는 방법
    - 시스템 다운 시간이 짧다. 
    - 성능이 향상 될 수 있다. 
  - Active-Standby 구성
    - Cold-Standby와 Hot-Standby로 구분된다.
    - Cold-Standby :  평소에 Standby-DB가 작돟하지 않다가 엑티브 디비가 다운 된 시점에 작동하는 구성
    - Hot-Standby : 평소에도 스탠바이 디비가 작동하는 구성.

### DB서버와 데이터의 다중화 - 리플리케이션
  - 저장소는 다중화 할수 없다는 문제로 인해 고안된 구성이 리플리케이션이다. 
  - 디비서버와 저장소 세트를 복수로 준비하는 것. 
  - 액티브 측과 스탠바이측의 데이터는 갱신 반영되 있어야 한다. 갱신 주기를 얼마로 할지 고민이 생김.

### 성능을 추구하기 위한 다중화 - Shared Nothing
  - 복수의 디비 서버가 1대의 저장소를 공유하는 구성을 'Shared Disk'라고 하고 병목 현상이 발생할 수 있다. 
  - 이를 극복하려 Shared Nothing이 나왔다. 즉 네트워크 이외의 자원을 모두 분리하는 방식이다. 
  - 서버와 저장소의 세트를 늘린다. (구글의 '샤딩').
  - 저장소를 공유하지 않아 각각의 디비서버가 동일한 1개의 데이터에 엑세스할 수밖에 없다.
    - 디비서버 하나가 다운되면 문제가 되는데 이를 해결하려 '커버링' 구성을 고려해야 한다. 


## 5장 DBMS를 조작할 떄 필요한 기본 지식
### MySQL과 커넥션 만들기
  - 로그인의 의미
    - MySql DBMS에 사용자가 로그인해 조작할 수 있게 된 상태를 의미.

### 데이터 베이스에 전화걸기
  - 커넥션의 이미지는 전화
    - MySQL은 동시에 여러 개의 커넥션 유지가 가능해 connection id를 커넥션에 붙인다. 
    - 커넥션 시작과 종료 사이 DBMS와 다양한 교환을 하게 되는데, 교환의 시작과 종료까지의 단위를 '세션'이라 한다. 

### SQL과 관리명령의 차의
  - 관리명령이란?
    - DBMS는 SQL이외에도 다양한 용도의 명령어를 준비해 두고 있다. 
    - 상태를 살펴보는 show status가 이에 해당한다. 
    - 관리 명령은 DBMS가 정상적으로 동작하는지 감시하거나 DBMS가 이상한 동작을 할 때 문제해결을 위해 정보수집을 하는 등의 용도로 사용한다. 
    - SQL 문은 반드시 'select, insert, delete, update' 중 하나의 단어로 시작하고, 나머지는 관리 명령이다. 

### 관계형 데이터베이스 계층
  - 데이터 베이스는 계층으로 나뉘어 있다.
  - 폴더에 해당하는 스키마
    - 스키마에 권환 관리 수행하는 것도 가능하다. 
    - 테이블은 실제 몇 개의 스키마 속에 저장된 형식을 취하고 있다.
  - 최상위에 있는 인스턴스
    - 데이터 베이스보다 한 층 더 위에 있는 인스턴스 라는 개념이 있다. (물리적 개념)
    - OS 입방에서 '프로세스'라고도 불린다 .DBMS에 따라서는 이것을 '서버프로세스' 또는 '서버'라고 부르는 경우도 있다. 
    - 한개의 인스턴스 아래 복수개의 데이터베이스가 있을 수 있고, 1개의 데이터베이스 아래에 복수의 스키마가 존재할수 있고, 1개의 스키마 아래는 복수개의 테이블이 존재할 수 있다.(4계층)
  - MySQL과 Oracle의 계층 구조
    - MySQL은 스키마와 데이터베이스를 동일한 것으로 간주해 계층의 차이를 두지 않는다. 그래서 3계층 구조이다.
    - Oracle은 4계층 구조로 되어 있지만 인스턴스 아래에 데이터 베이스를 한 개만 만들 수 있다는 제약이 있어 실질적으로 데이터베이스를 의식하지 않는다.
    - 3계층 : Oracle, MySQL
    - 4계층 : SQL Server, DB2, PostareSQL

## 6장 SQL 문의 기본
### Seelct문의 기본
  - 테이블 지정을 명시적으로 '데이터베이스명.테이블명' 형태로 할 수 있다. 
  >   select * from world.city;  // world 데이터베이스에 city 테이블
### Select문 응용
  - 한 행으로 집약하려면 'group_concat' 명령어를 사용한다.
  >   select group_concat(name) form city where countrycode ='kor' and district = 'chollabuk';
  - 정렬 수행 시 주의할 점
    - 정렬키가 같은 값의 행이 복수개 존재 한다면, 그 행들의 순서는 일정하지 않다. 
  - 테이블을 요약하는 함수
    - 함수에는 복수행을 집계하는 함수(집약함수), 단일 행의 값에 대해 조작이나 계산을 수행하는 함수가 있다. 
    - 집약 함수는 null을 제외하고 집계한다. 단 count만 count(*)로 표기 하여 null을 포함한 전체 행을 집계한다. 
  - 문자열을 집약하는 group_concat
    - sum함수는 수치에 대한 집계를 더해 수행하지만, group_concat은 문자열에 대한 집계를 문자열의 결합으로 수행한다. 
### Insert문
  - insert시 values에 모든 값을 지정한다면 테이블명의 열 리스트를 생략 할 수 있다.
  >   insert into city values(Default, 'Gimpo', 'Kor', 'Kyonggi', 439900);
  - insert에 기본값을 입력하는 방법은 values에 'default'를 입력하거나, 열 리스트로부터 빼서 암묵적으로 지정하는 방법이 있다. 
  - 데이터를 복수로 insert하는 방법
  >   insert into 테이블1 select * from 테이블2;
  - create table 테이블명1 like 테이블명2; 테이블2와 같은 구조의 테이블을 작성한다.
  - 신규 복수행을 입력하려면 vlaues뒤의 괄호를 콤마로 연결해 하나의 문장처럼 작성할 수 있다. 
  >   insert into city (name, contrycode, district, population) values('gimpo', 'kor', kyonggi', 349000), ('phcheon', 'kor', 'kyongigi', 155192);
### 뷰 작성
  - create view로 하면 된다. 
  - create view citykyonggi as select id, name, population from city where countrycode='KOR' and district='Kyonggi';
### 결합
  - 결합은 외부 결홥과 내부 결합이 있다.
  - 내부결합 : 2개의 테이블에서 필요한 열을 가지고 올 때 행을 결합하기 위한 조건을 'ON'으로 지정한다. 내부 결합에서는 이 ON으로 지정한 결합 조건에 일치하는 행만을 2개의 테이블로 부터 가져올 수 있다. 
    - select 선택 하고 싶은 열 리스트 from 첫번째 테이블 inner join 두번쨰 테이블 on 결합조건;
  - 외부결합 : 한쪽 테이블 기준으로 전체 행을 표시하고 다른 테이블은 값이 있으면 표시.
    - select 선택 하고 싶은 열 리스트 from 첫번째 테이블 left outer join 두번쨰 테이블 on 결합조건;
    - right outer join이라는 것도 있다. 
    

